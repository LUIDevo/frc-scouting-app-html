<html>
  <head>
    <title>Overview</title>
    <style>
.position-question-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
span {
  color: white;
}
.header-container {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
[role="button"] {
  all: unset;   padding: 0;
  background: none;
  border: none;
  text-align: inherit;
  cursor: inherit;
}
#human, #middle, #opposite {
  border: 1px solid #818181;
}
#human.active, #middle.active, #opposite.active {
  border: 1px solid #0367FB;
  background-color: #CAD5F0;
}
.position-container {
  margin-top: 2px;
  margin-bottom: 16px;
  display: flex;
  gap: 16px;
}
.submit-button {
  font-family: Jetbrains;
  font-size: 16px;
  width: 100%;
  border-radius: 4px;
  background-color: #CAD5F0;
  color: black;
  padding: 12px 0px;
  margin-top: 2%;
  margin-bottom: 60px;
}
@font-face {
  font-family: "Jetbrains";
  src: url(./fonts/JETBRAINSMONONL-MEDIUM.TTF);
}
.flex {
  display: flex;
}
* {
  box-sizing: border-box;
}

.sub-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
input {
  font-family: Jetbrains;
  border: 1px solid #818181;
  border-radius: 4px;
  padding: 8px 24px;
}
.input-container {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

html {
  background-color: #1d2021;
  height: 100vh;
}
body {
  margin: 0;
  font-family: Jetbrains, sans-serif;
}
.content {
  display: flex;
  justify-content: space-between;
  background-color: #1D2021;
  color: #F9F5D7;
}
.content-container {
  padding: 30px;
  display: flex;
  margin-bottom: 32px;
  align-items: center;
  flex-direction: column;
}
.left {
  display: flex;
  flex-direction: column;
  gap: 4px;
  justify-content: space-between;
  width: 100%;
}
.right {
  min-width: 400px;
  align-items: flex-end;
  justify-content: center;
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  gap: 8px;
}
.card {
  transition: background-color 0.3s ease-in-out;
  padding: 8px 24px;
  display: flex;
  border-bottom: 4px;
  border-radius: 4px;
  align-items: center;
  width: 50%;
  justify-content: center;
  background-color: #F9F5D7;
  color: black;
  border: 1px solid #B1B1B1;
}
.card-container-container {
  display: flex;
  flex-direction: column;
  gap: 8px;
  width: 100%;
    font-size: 12px;
}
.card-container {
  align-items: center;
  justify-content: space-between;
  width: 100%;
  display: flex;
  gap: 16px;
}
.header {
  font-size: 44px;
  text-align: center;
  margin-bottom: 2%;
}
.underline {
  height: 2px;
  background-color: #ffff;
  width: 100%;
}
.counter {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;

}
.counter-container {
  background: #282828;
  padding: 8px 16px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  width: 62%;
  justify-content: space-between;
  min-width: 300px;
  text-align: center;
}
.counter-label {
  font-size: 18px;
  margin-bottom: 5px;
}
label {
  font-size: 14px;
  letter-spacing: -0.2px;
}
.counter-value {
  color: white;
  font-size: 16px;
  font-weight: bold;
  margin: 5px 0;
}
.button-container {
  display: flex;
  gap: 10px;
}
button {
  background: #CAD5F0;
  color: black;
  border: none;
  padding: 8px 12px;
  font-size: 18px;
  cursor: pointer;
  border-radius: 4px;
}
.card.active {
  border: 1px solid #0367FB;
  background: #CAD5F0;
}
</style>
  </head>
<body>
  <div class="content-container">
      <div class="content">
    <div class="left">
        <div class="header-container">
          <div><b>Northview Robotics 6632 /</b> <span>Post-Game</span></div>
          <div class="underline"></div>
        </div>
      <div class="card-container-container">
        Climb level (Shallow means high):
        <div class="card-container">
          <div class="card" id="low">Deep</div>
          <div class="card" id="high">Shallow</div>
        </div>
      </div>
      <div class="card-container-container">
        Penalty:
        <div class="card-container">
          <div class="card" id="penalty-no">No</div>
          <div class="card" id="penalty-yes">Yes</div>
        </div>
      </div>
      <div class="card-container-container">
        Coopertition:
        <div class="card-container">
          <div class="card" id="no-coop">No</div>
          <div class="card" id="yes-coop">Yes</div>
        </div>
      </div>
        <div class="input-container col">
          <label>Match Number:</label>
          <input id="matchNumber" type="number">
        </div>
        <div class="input-container col">
          <label>Team Name:</label>
          <input id="teamName" type="number">
        </div>
        <div class="input-container col">
          <label>Additional comments (Notable events, how the robot performed in auto, any breakages, etc.)</label>
          <input id="comments" type="text">
        </div>
    </div>
<div class="right">
  <div id="num_missed_goals" class="counter-container">
    <label>Missed Goals</label>
          <div class="counter-change-container">
    <button data-key="num_missed_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_missed_goals" data-action="increment">+</button>
          </div>
  </div>

  <div id="num_human_goals" class="counter-container">
    <label>Human Goals</label>
          <div class="counter-change-container">
    <button data-key="num_human_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_human_goals" data-action="increment">+</button>
          </div>
  </div>

  <div id="num_net_goals" class="counter-container">
    <label>Net Goals</label>
          <div class="counter-change-container">
    <button data-key="num_net_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_net_goals" data-action="increment">+</button>
          </div>
  </div>

  <div id="num_processor_goals" class="counter-container">
    <label>Processor Goals</label>
          <div class="counter-change-container">
    <button data-key="num_processor_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_processor_goals" data-action="increment">+</button>
          </div>
  </div>

  <div id="num_l1" class="counter-container">
    <label>Level 1</label>
          <div class="counter-change-container">
    <button data-key="num_l1" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l1" data-action="increment">+</button>
          </div>
  </div>

  <div id="num_l2" class="counter-container">
    <label>Level 2</label>
          <div class="counter-change-container">
    <button data-key="num_l2" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l2" data-action="increment">+</button>
          </div>
  </div>

  <div id="num_l3" class="counter-container">
    <label>Level 3</label>
          <div class="counter-change-container">
    <button data-key="num_l3" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l3" data-action="increment">+</button>
          </div>
  </div>

  <div id="num_l4" class="counter-container">
    <label>Level 4</label>
        <div class="counter-change-container">
    <button data-key="num_l4" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l4" data-action="increment">+</button>
        </div>
  </div>

</div>
  </div>
      
  <button id="submitButton" class="submit-button" type="button">Continue â†’</button>
    </div>
<script>
document.getElementById("penalty-no").addEventListener("click", () => setPenalty("no"));
document.getElementById("penalty-yes").addEventListener("click", () => setPenalty("yes"));

document.getElementById("no-coop").addEventListener("click", () => setCoop("no"));
document.getElementById("yes-coop").addEventListener("click", () => setCoop("yes"));

document.getElementById("high").addEventListener("click", () => setClimbLevel("high"));
document.getElementById("low").addEventListener("click", () => setClimbLevel("low"));

let values = {
  teamNumber: 0,
  matchNumber: 0,
  teamPosition: "",
  teamColor: "",
  num_human_goals: 0,
  num_processor_goals: 0,
  num_missed_goals: 0,
  num_net_goals: 0,
  num_l1: 0,
  num_l2: 0,
  num_l3: 0,
  num_l4: 0,
  climbLevel: "",
  penalty: "",
  coopertition: "",
  comments: ""
};

// Extract parameters from the URL
const params = new URLSearchParams(window.location.search);
console.log("Loaded params:", params.toString());

const dataParam = params.get('data');
if (dataParam) {
  try {
    const parsedData = JSON.parse(decodeURIComponent(dataParam));
    console.log("Parsed data:", parsedData);

    Object.keys(parsedData).forEach((key) => {
      values[key] = parsedData[key];
    });
  } catch (e) {
    console.error("Error parsing 'data' parameter:", e);
  }
}

// Merge all URL parameters into `values`
params.forEach((value, key) => {
  if (key !== 'data' && value.trim() !== "") {
    values[key] = isNaN(value) ? value : parseFloat(value);
  }
});

// Update UI
const updateUI = () => {
  console.log("Updating UI...");
  
  // Update numeric counters
  const counters = [
    "num_missed_goals",
    "num_human_goals",
    "num_net_goals",
    "num_processor_goals",
    "num_l1",
    "num_l2",
    "num_l3",
    "num_l4"
  ];

  counters.forEach((key) => {
    const counterSpan = document.querySelector(`#${key} .counter-value`);
    if (counterSpan) {
      counterSpan.textContent = values[key];
    } else {
      console.warn(`Counter element for ${key} not found.`);
    }
  });

  // Set active states for buttons
  setPenalty(values.penalty);
  setCoop(values.coopertition);
  setClimbLevel(values.climbLevel);
};

function setCoop(coop) {
  values.coopertition = coop;
  document.getElementById("no-coop").classList.toggle("active", coop === "no");
  document.getElementById("yes-coop").classList.toggle("active", coop === "yes");
}

function setClimbLevel(climbLevel) {
  values.climbLevel = climbLevel;
  document.getElementById("high").classList.toggle("active", climbLevel === "high");
  document.getElementById("low").classList.toggle("active", climbLevel === "low");
}

function setPenalty(penalty) {
  values.penalty = penalty;
  document.getElementById("penalty-no").classList.toggle("active", penalty === "no");
  document.getElementById("penalty-yes").classList.toggle("active", penalty === "yes");
}

// Handle counter buttons
document.body.addEventListener("click", (event) => {
  const button = event.target;
  const key = button.getAttribute("data-key");
  const action = button.getAttribute("data-action");

  if (key && action) {
    if (action === "increment") values[key]++;
    if (action === "decrement") values[key]--;
    updateUI();
  }
});

// Handle form submission
document.getElementById("submitButton")?.addEventListener("click", () => {
  console.log("Submitting data...");
  values.matchNumber = document.getElementById('matchNumber').value;
  values.teamNumber= document.getElementById('teamName').value;
  values.comments= document.getElementById('comments').value;

  console.log(matchNumber)
  // Construct new URL parameters
  const newParams = new URLSearchParams();

  Object.keys(values).forEach((key) => {
    if (values[key] !== "") {
      newParams.set(key, values[key]);
    }
  });

  // Navigate to the new URL
  window.location.href = `dashboard.html?${newParams.toString()}`;
});

// Initialize UI with updated values
updateUI();
</script>
</body>
</html>
