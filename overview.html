<html>
  <head>
    <title>Overview</title>
    <style>
.position-question-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
[role="button"] {
  all: unset;   padding: 0;
  background: none;
  border: none;
  text-align: inherit;
  cursor: inherit;
}
#human, #middle, #opposite {
  border: 1px solid #818181;
}
#human.active, #middle.active, #opposite.active {
  border: 1px solid #0367FB;
  background-color: #CAD5F0;
}

.position-container {
  margin-top: 2px;
  margin-bottom: 16px;
  display: flex;
  gap: 16px;
}
.box {
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 8px;
  width:50%;
  border-radius: 4px;
  transition: all 0.3s ease-in-out;
  border: 1px solid #B1B1B1;
}
.submit-button {
  font-family: Jetbrains;
  width: 60%;
  border-radius: 4px;
  background-color: #CAD5F0;
  color: black;
  padding: 12px 0px;
}
@font-face {
  font-family: "Jetbrains";
  src: url(./fonts/JETBRAINSMONONL-MEDIUM.TTF);
}
.flex {
  display: flex;
}
* {
  box-sizing: border-box;
}
span {
  color: black;
}

.sub-container {
  display: flex;
  flex-direction: column;
  gap: 24px;
}
input {
  font-family: Jetbrains;
  border: 1px solid #818181;
  border-radius: 4px;
  padding: 12px 24px;
}
.input-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
body {
  margin: 0;
  font-family: Jetbrains, sans-serif;
  background-color: white;
}
.content {
  display: flex;
  justify-content: space-between;
  padding: 20px;
}
.left {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: 40%;
}
.right {
  width: 55%;
  align-items: center;
  justify-content: center;
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  gap: 15px;
}
.card {
  padding: 8px 24px;
  display: flex;
  border-bottom: 4px;
  border-radius: 4px;
  align-items: center;
  width: 50%;
  justify-content: center;
  background-color: white;
  border: 1px solid #B1B1B1;
}
.card-container-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: 100%;
}
.card-container {
  align-items: center;
  justify-content: space-between;
  width: 100%;
  display: flex;
  gap: 16px;
}
.header {
  font-size: 44px;
  text-align: center;
  margin-bottom: 10px;
}
.underline {
  height: 2px;
  background-color: black;
  width: 100%;
}
.counter {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;

}
.counter-container {
  background: #ffff;
  padding: 15px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  width: 62%;
  min-width: 150px;
  text-align: center;
}
.counter-label {
  font-size: 18px;
  margin-bottom: 5px;
}
.counter-value {
  font-size: 22px;
  font-weight: bold;
  margin: 5px 0;
}
.button-container {
  display: flex;
  gap: 10px;
}
button {
  background: #CAD5F0;
  color: black;
  border: none;
  padding: 8px 12px;
  font-size: 18px;
  cursor: pointer;
  border-radius: 5px;
}
.card.active {
  border: 1px solid #0367FB;
  background-color: #CAD5F0;
}
</style>
  </head>
<body>
  <div class="content">
    <div class="left">
      <div><b>Northview Robotics 6632 /</b> <span>Post-Game</span></div>
      <div class="underline"></div>
      <div class="card-container-container">
        Climb level:
        <div class="card-container">
          <div class="card" id="low">Low</div>
          <div class="card" id="high">High</div>
        </div>
      </div>
      <div class="card-container-container">
        Penalty:
        <div class="card-container">
          <div class="card" id="penalty-no">No</div>
          <div class="card" id="penalty-yes">Yes</div>
        </div>
      </div>
      <div class="card-container-container">
        <div>Team Color:</div>
        <div class="card-container">
          <div class="card" id="red">Red</div>
          <div class="card" id="blue">Blue</div>
        </div>
      </div>
      <div class="position-question-container">
        <label for="position-selection">Which side is the robot closest to?</label>
        <div class="position-container" role="group" aria-labelledby="position-selection">
          <button type="button" class="box" id="human" role="button" aria-pressed="false">Processor</button>
          <button type="button" class="box" id="middle" role="button" aria-pressed="false">Middle</button>
          <button type="button" class="box" id="opposite" role="button" aria-pressed="false">Opposite</button>
        </div>
      </div>
      <form id="scoutForm" class="flex col sub-container">
        <div class="input-container col">
          <label>Scout name:</label>
          <input id="scoutId"  type="text">
        </div>
        <div class="input-container col">
          <label>Match Number:</label>
          <input id="matchNumber" type="number">
        </div>
        <div class="input-container col">
          <label>Team Name:</label>
          <input id="teamName" type="number">
        </div>
      </form>
    </div>
<div class="right">
  <div id="num_missed_goals" class="counter-container">
    <label>Missed Goals</label>
    <button data-key="num_missed_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_missed_goals" data-action="increment">+</button>
  </div>

  <div id="num_human_goals" class="counter-container">
    <label>Human Goals</label>
    <button data-key="num_human_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_human_goals" data-action="increment">+</button>
  </div>

  <div id="num_net_goals" class="counter-container">
    <label>Net Goals</label>
    <button data-key="num_net_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_net_goals" data-action="increment">+</button>
  </div>

  <div id="num_processor_goals" class="counter-container">
    <label>Processor Goals</label>
    <button data-key="num_processor_goals" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_processor_goals" data-action="increment">+</button>
  </div>

  <div id="num_l1" class="counter-container">
    <label>Level 1</label>
    <button data-key="num_l1" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l1" data-action="increment">+</button>
  </div>

  <div id="num_l2" class="counter-container">
    <label>Level 2</label>
    <button data-key="num_l2" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l2" data-action="increment">+</button>
  </div>

  <div id="num_l3" class="counter-container">
    <label>Level 3</label>
    <button data-key="num_l3" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l3" data-action="increment">+</button>
  </div>

  <div id="num_l4" class="counter-container">
    <label>Level 4</label>
    <button data-key="num_l4" data-action="decrement">-</button>
    <span class="counter-value">0</span>
    <button data-key="num_l4" data-action="increment">+</button>
  </div>

  <button id="submitButton" class="submit-button" type="button">Continue â†’</button>
</div>
  </div>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const values = {
    scoutId: "",
    teamNumber: 0,
    matchNumber: 0,
    teamPosition: "",
    teamColor: "",
    num_human_goals: 0,
    num_processor_goals: 0,
    num_missed_goals: 0,
    num_net_goals: 0,
    num_l1: 0,
    num_l2: 0,
    num_l3: 0,
    num_l4: 0,
    climbLevel: "",
    penalty: ""
  };

  // Load game data from localStorage and populate values
  const gameData = JSON.parse(localStorage.getItem("gamesData")) || {};
  console.log("Loaded gamesData:", gameData);

  const currentGame = gameData["12"] || {}; // Assuming game ID "12"
  console.log("Current game data:", currentGame);

  // Populate values from gameData or localStorage
  Object.keys(values).forEach((key) => {
    if (key in currentGame) {
      values[key] = currentGame[key];
    } else {
      const storedValue = localStorage.getItem(key);
      values[key] = storedValue !== null ? (isNaN(storedValue) ? storedValue : parseInt(storedValue)) : values[key];
    }
  });

  console.log("Final values object:", values);

  // Ensure elements exist before accessing them
  if (document.getElementById("scoutId")) document.getElementById("scoutId").value = values.scoutId;
  if (document.getElementById("matchNumber")) document.getElementById("matchNumber").value = values.matchNumber;
  if (document.getElementById("teamName")) document.getElementById("teamName").value = values.teamNumber;

  const updateUI = () => {
    console.log("Updating UI...");

    const counters = [
      "num_missed_goals",
      "num_human_goals",
      "num_net_goals",
      "num_processor_goals",
      "num_l1",
      "num_l2",
      "num_l3",
      "num_l4"
    ];

    counters.forEach((key) => {
    const counterSpan = document.querySelector(`#${key} .counter-value`);
      if (counterSpan) {
        counterSpan.textContent = values[key];
      } else {
        console.warn(`Counter element for ${key} not found.`);
      }
    });
  };

  // Event delegation for all counter buttons
  document.body.addEventListener("click", (event) => {
    const button = event.target;
    const key = button.getAttribute("data-key");
    const action = button.getAttribute("data-action");

    if (key && action) {
      if (action === "increment") values[key]++;
      if (action === "decrement") values[key]--;

      localStorage.setItem(key, values[key]); // Save to localStorage
      updateUI(); // Update UI dynamically
    }
  });

document.getElementById("submitButton")?.addEventListener("click", () => {
  if (!values.teamNumber) {
    alert("Please enter the team name.");
    return;
  }
  if (!values.scoutId) {
    alert("Please enter the scout ID.");
    return;
  }
  //! BUG 
  //  if (!values.matchNumber) {
  //  alert("Please enter the match number.");
  //  return;
  //}

  // Ensure gamesData exists in localStorage and is parsed correctly
  let gamesData = JSON.parse(localStorage.getItem("gamesData")) || {};

  // Ensure the game entry exists before modifying it
  if (!gamesData[values.matchNumber]) {
    gamesData[values.matchNumber] = {}; // Initialize if missing
  }

  // Update the game data **for the current match**
  Object.keys(values).forEach((key) => {
    if (key !== "teamColor") {
      gamesData[values.matchNumber][key] = values[key];
    }
  });

  // Store the updated gamesData object
  localStorage.setItem("gamesData", JSON.stringify(gamesData));

  console.log("Updated game data:", gamesData);

  setTimeout(() => {
    window.location.href = "dashboard.html";
    console.log("Navigation successful");
  }, 0);
});

  // Initialize UI
  updateUI();
});
</script>
</body>
</html>
